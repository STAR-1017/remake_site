(window._ambjs=window._ambjs||[]).push([[55],{DcaC:function(t,i,e){var a=e("Izvo"),n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},s=Object.defineProperty||function(t,i,e){t[i]=e.value};"string"==typeof a&&(a=[[t.i,a,""]]),t.exports=function(t){var i=n({},t.locals||{});return s(i,"_",{value:function(){return t}}),s(i,"toString",{value:function(){return"function"==typeof t.toString?t.toString():""}}),i}(a)},Izvo:function(t,i,e){var a=e("Ai0b")(!1);a.push([t.i,'._2VzEbtkU{font-size:0;margin:2rem 0 4rem;max-width:288px;position:relative;width:100%}._W0kQ9fLa{background:#f8f8f8;border-radius:8px;font-size:0}._W0kQ9fLa:before{content:"";display:block;padding-top:177.77%}._187bB8bb{bottom:0;color:#ccc;font-size:120px;height:120px;left:0;margin:auto;position:absolute;right:0;top:0;width:120px}',""]),a.locals={Block:"_2VzEbtkU",Placeholder:"_W0kQ9fLa",Icon:"_187bB8bb"},t.exports=a},U0FC:function(t,i,e){"use strict";e.d(i,"a",(function(){return T}));var a,n,s,r=e("5n0U"),o=(e("W0B4"),e("mXGw")),p=e.n(o),l=e("Samx"),h=e.n(l),c=e("1IY1"),d=e("lalP"),u=e.n(d),m=e("5kfR"),y=e("7VD8"),C=e("zeu+"),b=e("d7u7"),f=e("DcaC"),I=e.n(f),T=Object(c.d)(I.a)((s=n=class t extends p.a.Component{constructor(t){super(t),this.playStartDate=null,this.playStartDateCache=null,this.playTime=0,this.playTimeCache=0,this.currentTime=null,this.currentTimeCache=null,this.setEntryInformation=this.setEntryInformation.bind(this),this.onStart=this.onStart.bind(this),this.onPlay=this.onPlay.bind(this),this.onTimeup=this.onTimeup.bind(this),this.onPause=this.onPause.bind(this),this.onEnded=this.onEnded.bind(this)}componentDidMount(){this.initialize()}shouldComponentUpdate(t){return this.props.amebaId!==t.amebaId||this.props.entryId!==t.entryId||this.props.duration!==t.duration||this.props.pathname!==t.pathname||this.props.playCount!==t.playCount||this.props.id!==t.id||this.props.trackEndClip!==t.trackEndClip||this.props.trackProgressClip!==t.trackProgressClip||this.props.trackStartClip!==t.trackStartClip}componentDidUpdate(t){this.props.pathname!==t.pathname&&(this.reset(),this.initialize()),this.props.duration===t.duration&&this.props.playCount===t.playCount||this.setEntryInformation({duration:this.props.duration,playCount:this.props.playCount})}componentWillUnmount(){this.reset()}onStart(t){this.playStartDate=this.playStartDate||h()(Date.now(),C.a.CLIP_PLAYER_LOG_DATE);var{amebaId:i,duration:e,entryId:a,id:n}=this.props,s={entryId:a,clipId:n,bloggerAmebaId:i,playheadTime:t.video.currentTime||"0",playMedia:"main-player",duration:e};this.props.trackStartClip(s)}onPlay(){this.playStartDateCache=Date.now()}onTimeup(t){if(this.playStartDate){if(this.playStartDateCache){var i=(Date.now()-this.playStartDateCache)/1e3;this.playTime=this.playTimeCache+i}var e=Math.floor(t.video.currentTime);if(e%5==0&&e!==this.currentTimeCache){this.currentTimeCache=e;var{amebaId:a,duration:n,entryId:s,id:r}=this.props,o={entryId:s,clipId:r,bloggerAmebaId:a,playheadTime:t.video.currentTime||"0",playMedia:"main-player",duration:n,playStartDate:this.playStartDate,playTime:this.playTime||"0"};this.props.trackProgressClip(o)}}}onPause(){this.clearLogCache()}onEnded(){var{amebaId:t,duration:i,entryId:e,id:a}=this.props,n={entryId:e,clipId:a,bloggerAmebaId:t,playMedia:"main-player",duration:i,playStartDate:this.playStartDate,playTime:this.playTime||"0"};this.props.trackEndClip(n),this.clearLogCache()}setEntryInformation(t){this.clip&&this.clip.setEntryInformation(t)}mount(){var t=window.ClipDesktopPlayerApp;t&&(this.clearClip(),this.clip=new t(this.props.id),this.clip.on(t.Events.START,this.onStart),this.clip.on(t.Events.PLAY,this.onPlay),this.clip.on(t.Events.TIMEUP,this.onTimeup),this.clip.on(t.Events.PAUSED,this.onPause),this.clip.on(t.Events.ENDED,this.onEnded),this.clip.mount(this.target))}load(){return Object(m.a)("".concat(window.process.env.HTTP_PATH_CLIPBLOG,"/js/").concat(y.a.PLAYER_FILE_VERSION,"/clipDesktopPlayerApp.js"))}initialize(){this.target&&this.load().then(()=>{this.mount(),this.setEntryInformation({duration:this.props.duration,playCount:this.props.playCount}),this.startListen()})}handleEnter(){this.clip&&(this.clip.status.isEnded||this.clip.play())}handleLeave(){this.clip&&(this.clip.status.isFullscreen||this.clip.pause())}clearLogCache(){this.currentTimeCache=null,this.playStartDateCache=null,this.playTimeCache=this.playTime}clearLog(){this.currentTime=null,this.currentTimeCache=null,this.playStartDateCache=null,this.playStartDate=null,this.playTime=0,this.playTimeCache=0}startListen(){t.intersectionListener||(t.intersectionListener=Object(b.a)({threshold:.5})),this.stopListen(),this.unlisten=t.intersectionListener.listen(this.target,t=>{t.intersectionRatio>=.5?this.handleEnter():this.handleLeave()})}stopListen(){this.unlisten&&(this.unlisten(),this.unlisten=null)}clearClip(){this.clip&&(this.clip.destroy(),this.clip=null)}reset(){this.stopListen(),this.clearClip(),this.clearLog()}render(){return this.props.id?p.a.createElement("div",{className:I.a.Block,ref:t=>{this.target=t}},Object(r.a)("div",{className:I.a.Placeholder},void 0,Object(r.a)(u.a,{"aria-label":"\u52d5\u753b",className:I.a.Icon}))):null}},n.displayName="PcEntryClip",n.intersectionListener=void 0,a=s))||a}}]);