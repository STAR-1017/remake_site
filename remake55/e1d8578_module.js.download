(window._ambjs=window._ambjs||[]).push([[19],{"/HKI":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i}));var r={};n.r(r),n.d(r,"getSessionUser",(function(){return f}));var o={};n.r(o),n.d(o,"executeIine",(function(){return v})),n.d(o,"cancelIine",(function(){return O})),n.d(o,"getIineInfoForDisplay",(function(){return j}));var a={};n.r(a),n.d(a,"getMemberChecklist",(function(){return w})),n.d(a,"getMemberFollowing",(function(){return k})),n.d(a,"follow",(function(){return g})),n.d(a,"unfollow",(function(){return I})),n.d(a,"fetchRemainingFollow",(function(){return _}));var i={};n.r(i),n.d(i,"generateToken",(function(){return M})),n.d(i,"checkAmebloToken",(function(){return E}));var u=n("xkUh"),c=n("lm4X");var l=n("FLC0");var f=e=>Object(u.a)()?function(e){return Object(c.a)("getBlog",{token:e})}(e):function(e){if(!e)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/blog",{token:e})}(e),s=n("eijD");function d(){return(d=Object(s.a)((function*(e,t,n,r){return(yield Object(c.a)("execIine",{receiveAmebaId:e,entryId:t,token:r,from:"entry",device:n})).data}))).apply(this,arguments)}function b(){return(b=Object(s.a)((function*(e,t,n,r){return(yield Object(c.a)("cancelIine",{receiveAmebaId:e,entryId:t,token:r,from:"entry",device:n})).data}))).apply(this,arguments)}function p(){return(p=Object(s.a)((function*(e,t,n){return(yield Object(c.a)("displayIine",{receiveAmebaId:e,entryId:t,token:n})).data}))).apply(this,arguments)}function y(){return(y=Object(s.a)((function*(e,t,n,r){if(!(e&&t&&n&&r))throw new Error("Invalid Parameter");return(yield Object(l.a)("/_api/ameblo/iine/exec",{receiveAmebaId:e,entryId:t,token:r,from:"entry",device:n})).data}))).apply(this,arguments)}function m(){return(m=Object(s.a)((function*(e,t,n,r){if(!(e&&t&&n&&r))throw new Error("Invalid Parameter");return(yield Object(l.a)("/_api/ameblo/iine/cancel",{receiveAmebaId:e,entryId:t,token:r,from:"entry",device:n})).data}))).apply(this,arguments)}function h(){return(h=Object(s.a)((function*(e,t,n){if(!e||!t)throw new Error("Invalid Parameter");return(yield Object(l.a)("/_api/ameblo/iine/display",{receiveAmebaId:e,entryId:t,token:n})).data}))).apply(this,arguments)}var v=(e,t,n,r)=>Object(u.a)()?function(e,t,n,r){return d.apply(this,arguments)}(e,t,n,r):function(e,t,n,r){return y.apply(this,arguments)}(e,t,n,r),O=(e,t,n,r)=>Object(u.a)()?function(e,t,n,r){return b.apply(this,arguments)}(e,t,n,r):function(e,t,n,r){return m.apply(this,arguments)}(e,t,n,r),j=(e,t,n)=>Object(u.a)()?function(e,t,n){return p.apply(this,arguments)}(e,t,n):function(e,t,n){return h.apply(this,arguments)}(e,t,n);var w=(e,t)=>Object(u.a)()?function(e,t){return Object(c.a)("getChecklistIds",{token:e,cursor:t})}(e,t):function(e,t){if(!e)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/checklist",{token:e,cursor:t})}(e,t),k=(e,t)=>Object(u.a)()?function(e,t){return Object(c.a)("getFollowing",{token:e,targetAmebaId:t})}(e,t):function(e,t){if(!e||!t)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/follow/get",{token:e,targetAmebaId:t})}(e,t),g=(e,t,n,r,o,a)=>Object(u.a)()?function(e,t,n,r,o,a){return Object(c.a)("follow",{token:e,targetAmebaId:t,type:n,browserPush:r,sendMail:o,mineRequestRoute:a})}(e,t,n,r,o,a):function(e,t,n,r,o,a){if(!e||!t)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/follow/post",{token:e,targetAmebaId:t,type:n,browserPush:r,sendMail:o,mineRequestRoute:a})}(e,t,n,r,o,a),I=(e,t)=>Object(u.a)()?function(e,t){return Object(c.a)("unfollow",{token:e,targetAmebaId:t})}(e,t):function(e,t){if(!e||!t)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/follow/delete",{token:e,targetAmebaId:t})}(e,t),_=e=>Object(u.a)()?function(e){return Object(c.a)("fetchRemainingFollow",{token:e})}(e):function(e){if(!e)throw new Error("Invalid Parameter");return Object(l.a)("/_api/ameblo/follow/limits/remaining",{token:e})}(e);function A(){return(A=Object(s.a)((function*(){return(yield Object(c.a)("generateToken",{})).data}))).apply(this,arguments)}function P(){return(P=Object(s.a)((function*(e){return(yield Object(c.a)("checkAmebloToken",{token:e})).data}))).apply(this,arguments)}function T(){return(T=Object(s.a)((function*(){return(yield Object(l.a)("/_api/ameblo/token/generate",{})).data}))).apply(this,arguments)}function S(){return(S=Object(s.a)((function*(e){if(!e)throw new Error("Invalid Parameter");return(yield Object(l.a)("/_api/ameblo/token/check",{token:e})).data}))).apply(this,arguments)}var M=()=>Object(u.a)()?function(){return A.apply(this,arguments)}():function(){return T.apply(this,arguments)}(),E=e=>Object(u.a)()?function(e){return P.apply(this,arguments)}(e):function(e){return S.apply(this,arguments)}(e)},"L+MQ":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var u={times:5,intervalFunc:a(0)};arguments.length<3&&"function"==typeof e?(n=t||(0,o.promiseCallback)(),t=e):(i(u,e),n=n||(0,o.promiseCallback)());if("function"!=typeof t)throw new Error("Invalid arguments for async.retry");var c=(0,r.default)(t),l=1;function f(){c((function(e){if(!1!==e)if(e&&l++<u.times&&("function"!=typeof u.errorFilter||u.errorFilter(e)))setTimeout(f,u.intervalFunc(l-1));else{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];n(e,...r)}}))}return f(),n[o.PROMISE_SYMBOL]};var r=function(e){return e&&e.__esModule?e:{default:e}}(n("l/iq")),o=n("dMF1");function a(e){return function(){return e}}function i(e,t){if("object"==typeof t)e.times=+t.times||5,e.intervalFunc="function"==typeof t.interval?t.interval:a(+t.interval||0),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||5}}e.exports=t.default},P59d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,a.isAsync)(e))return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n.pop(),a=e.apply(this,n);return u(a,o)};return(0,r.default)((function(t,n){var r;try{r=e.apply(this,t)}catch(o){return n(o)}if(r&&"function"==typeof r.then)return u(r,n);n(null,r)}))};var r=i(n("iJ/f")),o=i(n("faTD")),a=n("l/iq");function i(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return e.then(e=>{c(t,null,e)},e=>{c(t,e&&e.message?e:new Error(e))})}function c(e,t,n){try{e(t,n)}catch(r){(0,o.default)(e=>{throw e},r)}}e.exports=t.default},dMF1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Symbol("promiseCallback");t.promiseCallback=function(){var e,t;function n(n){if(n)return t(n);for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];e(o.length>1?o:o[0])}return n[r]=new Promise((n,r)=>{e=n,t=r}),n},t.PROMISE_SYMBOL=r},faTD:function(e,t,n){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.fallback=i,t.wrap=u;var r,o=t.hasSetImmediate="function"==typeof e&&e,a=t.hasNextTick="object"==typeof n&&"function"==typeof n.nextTick;function i(e){setTimeout(e,0)}function u(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return e(()=>t(...r))}}r=o?e:a?n.nextTick:i,t.default=u(r)}).call(this,n("oPUo").setImmediate,n("5IsQ"))},"iJ/f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n.pop();return e.call(this,n,o)}},e.exports=t.default},"l/iq":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n("P59d"));function o(e){return"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){if("function"!=typeof e)throw new Error("expected a function");return o(e)?(0,r.default)(e):e},t.isAsync=o,t.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},t.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]}},othg:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return j}));var r=n("eijD"),o=n("wTO3"),a=n("L+MQ"),i=n.n(a),u=n("P59d"),c=n.n(u),l=n("edSL"),f=n.n(l),s=n("/HKI"),d=n("tDZY"),b=n("mGrS"),p=n("x9GJ"),y=n("jZ7E"),m=()=>({type:y.i}),h=e=>({type:y.d,payload:{userAttribute:e}}),v=Object(o.b)(()=>function(){var e=Object(r.a)((function*(e,t){var{userState:n,amebloTokenState:r}=t();if(n.userAttribute)return null;try{if(r.amebloToken){var o=yield i()({times:3},c()(()=>s.d.checkAmebloToken(r.amebloToken)));if(o&&1===o.member)return e(h(o))}var a=yield s.d.generateToken();if(!a)throw new Error("generate token error.");var u=a.ameblo_token,l=[];if(u){var f=yield i()({times:3},c()(()=>s.d.checkAmebloToken(u)));f&&1===f.member?l.push(e(h(f))):l.push(e(m()))}else l.push(e(m()));return l.push(e(((e,t)=>({type:y.h,payload:{amebloToken:e,amebloOneTimeToken:t}}))(u,a.ameblo_one_time_token))),Promise.all(l)}catch(d){return e((e=>({type:y.c,payload:{error:e},error:!0}))(d))}}));return function(t,n){return e.apply(this,arguments)}}());var O=Object(o.b)(()=>function(){var e=Object(r.a)((function*(e,t){if(f()(t(),["userState","sessionUser","amebaId"],""))return null;try{var n=f()(t(),["amebloTokenState","amebloToken"],""),r=yield s.a.getSessionUser(n);if(!r)return null;if(r.error)throw new Error(r.error);var o=(r.session_user||{}).ameba_id||"";if(!o)return null;yield e(Object(d.b)(o));var a=f()(t(),["bloggerState","bloggerMap",o],{});return e(function(e){return{type:y.b,payload:{sessionUser:e}}}({amebaId:o,profile_image:a.profile.image_filepath,nickname:a.profile.nickname,is_official:!!a.official}))}catch(i){return e(function(e){return{type:y.a,payload:{error:e},error:!0}}(i))}}));return function(t,n){return e.apply(this,arguments)}}()),j=Object(o.b)(()=>(e,t)=>{if(Object(p.a)(t())){e({type:y.e}),e({type:y.f});try{var n="amebloTokenState",r=JSON.parse(window.localStorage[b.a]||"{}");if(!r[n])return;delete r[n],window.localStorage.setItem(b.a,JSON.stringify(r))}catch(o){console.error(o)}}})}}]);